---
output: rmarkdown::github_document

title: Análisis de contenido de nutrientes en savia, y su relación con el rendimiento en plantas de Solnum tuberosum

author:
  name: David Alejandro Agudelo Castillo
---

```{r}
knitr::opts_chunk$set(fig.width=12, fig.height=8)
```

```{r}
setwd("C:/Users/david/OneDrive/Escritorio/Personal/R")
```

### 1) CONTENIDO EN SAVIA EN EL TIEMPO

Primero que todo, vamos a utilizar la información de elementos contenidos en savia, determinados en diferentes momentos para los tratamientos en cuestión.

```{r}
library(readxl)
mccain_savia <- read_excel("C:/Users/david/OneDrive/Escritorio/Personal/R/mccain_savia.xlsx")
head(mccain_savia)
```

Inicialmente, se realiza un análisis exploratorio del dataframe utilizado, para tener claridad sobre las variables a implementar posteriormente.

```{r}
names(mccain_savia)
```

Por cuestiones de estética, se realiza un primer apartado en el cual se definen los estándares de los gráficos que se generarán más adelante.

En este caso, utilizaremos la librería ggplot2.

```{r}
library(ggplot2)

tema <-   theme(legend.position="bottom",panel.background = element_rect(fill = NA),panel.grid.major.y = element_line(colour = "grey90"),legend.key = element_rect(fill = "white"),axis.line = element_line(colour = "grey90"),legend.title = element_text(colour = "white"))
```

### ELMENTOS EN SAVIA

Para facilitar la ejecución de gráficos, se creará una función en la cual se especifique el dataframe a utilizar, la variedad de papa en cuestión, y la variable de interés.

La libraría dplyr nos permite generar consultas dentro de un dataframe prviamente incorporado, y almacenarlas dentro de un nuevo dataframe el cual se trabajará.

```{r}
library(dplyr)

# Define una función para simplificar el proceso de creación de gráficos
crear_grafico <- function(datos, variedad, variable) {
  nombre_variable <- as.character(substitute(variable))  # Obtener el nombre de la variable
  
  datos %>%
    filter(Variedad == variedad) %>%
    group_by(DDS, Tratamiento) %>%
    summarise(Variable = mean({{variable}}, na.rm = TRUE),
              DDS = DDS,
              TRATAMIENTO = Tratamiento,
              SE = sd({{variable}}, na.rm = TRUE) / sqrt(sum({{variable}}))) %>%
    ggplot(aes(x = DDS, y = Variable, group = TRATAMIENTO, colour = TRATAMIENTO, shape = TRATAMIENTO)) +
    geom_errorbar(aes(ymin = Variable - 2 * SE, ymax = Variable + 2 * SE), width = 1) +
    geom_line(size = 0.5) +
    scale_y_continuous(breaks = seq(0, 10000, 500)) +
    scale_x_continuous(breaks = seq(0, 150, 15)) +
    labs(title = paste(nombre_variable, "en savia - Variedad", variedad),
         subtitle = paste("Representación gráfica de medias para la variedad", variedad),
         caption = paste("Variedad", variedad),
         x = "DDS", y = paste("Contenido de", nombre_variable, "(ppm)")) +
    geom_point(size = 2, fill = "white") +
    scale_color_manual(values = c("seagreen2", "cadetblue3", "cadetblue4", "cadetblue2")) +
    tema
}

# Llamar a la función para cada variedad
grafico_variedad_1_NO3 <- crear_grafico(mccain_savia, "CIP 1", NO3)
grafico_variedad_1_K <- crear_grafico(mccain_savia, "CIP 1", K)
grafico_variedad_1_Ca <- crear_grafico(mccain_savia, "CIP 1", Ca)
grafico_variedad_39_NO3 <- crear_grafico(mccain_savia, "CIP 39", NO3)
grafico_variedad_39_K <- crear_grafico(mccain_savia, "CIP 39", K)
grafico_variedad_39_Ca <- crear_grafico(mccain_savia, "CIP 39", Ca)
grafico_variedad_102_NO3 <- crear_grafico(mccain_savia, "CIP 102", NO3)
grafico_variedad_102_K <- crear_grafico(mccain_savia, "CIP 102", K)
grafico_variedad_102_Ca <- crear_grafico(mccain_savia, "CIP 102", Ca)
```

```{r}
grafico_variedad_1_NO3
grafico_variedad_1_K
grafico_variedad_1_Ca
grafico_variedad_39_NO3
grafico_variedad_39_K
grafico_variedad_39_Ca
grafico_variedad_102_NO3
grafico_variedad_102_K
grafico_variedad_102_Ca
```

Con esto, podemos definir inicialmente que el comportamiento del calcio no está claro. En este caso, el argumento de esto no puede ser revelado.

### 2) MODELO PESOS SECOS

En este apartado, se tomarán datos de la producción de masa seca d las plantas, en estos tratamientos.

```{r}
library(readxl)
datos_masa_seca <- read_excel("C:/Users/david/OneDrive/Escritorio/Personal/R/masa_seca.xlsx")
head(datos_masa_seca)
```

```{r}
names(datos_masa_seca)
```

Por cuestiones de independencia en el análisis, se realizará y ejecutará el código para cada variedad de manera independiente, a diferencia de las primeras gráficas ejecutadas en el prsente script.

### VARIEDAD 1

Primero, se realiza una aproximación mdiante un gráfico de puntos, para comprender inicialmente el cmportamiento de la acumulaicón de biomasa.

```{r}
library(dplyr)

masa_seca_1 <- datos_masa_seca %>% 
  filter(VARIEDAD=="1")%>%
  group_by(DDS,TRATAMIENTO.)%>%
  summarise(PESO_TOTAL=mean(PESO_TOTAL,na.rm = T),
            DDS=DDS,
            TRATAMIENTO=TRATAMIENTO.)


ggplot() + geom_point(data=masa_seca_1, aes(x=DDS, y = PESO_TOTAL, group = TRATAMIENTO., colour = TRATAMIENTO.)) + 
  xlab("DDS") + 
  ylab("PESO TOTAL") + 
  ggtitle("") +
  tema
```

En este estudio, se implementa el **modelo de gompertz**, ya que este modelo define la acumulación de biomasa en especies vegetales.

Este modelo corresponde a una función sigmoidal, la cual describe la acumulaión de biomasa de forma lenta al inicio (baja síntesis de fotoasimilados) y al final del ciclo de vida (disminución de acumulación debido a la marchitez de la parte aérea de las plantas).

Este es un caso especial de la **función logística**, y la modificación implementada en este estudio se trabaja para poblaciones y acumulación de biomasa. La fórmula implementada corresponde a:

$$
  y = y0 + ymax*exp(-exp(k*(lag-x)/(ymax-y0) + 1))
$$

En este modelo, se tiene:

- **y0:** El valor inicial de la función. En este caso, no partimos de cero.
- **ymax:** Es el límite de la función, es deir, su valor máximo.
- **lag:** Es una fase inicial, en la cual no se genera acumulación de biomasa en la raíz, sino que se desarrolla tejido aéreo para la síntesis de fotoasimilados y retraslocación.
- **k:** Se relaciona con la velocidad de crcimiento máxima alcanzada.

Para evaluar el modelo, se utiliza el comando *nls*, el cual corresponde a la evaluación de modelos no lineales.

```{r}
Gompertz <- function(x, y0, ymax, k, lag){
  result<- y0 + (ymax)*exp(-exp(k*(lag-x)/(ymax-y0) + 1))
  return(result)
}

masa_seca_100_1 <- datos_masa_seca %>%
  filter(VARIEDAD =="1",TRATAMIENTO.=="100% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_100_1=PESO_TOTAL,
            DDS_100_1=DDS,
            TRATAMIENTO=TRATAMIENTO.)

Gomp_100_1 <- nls(PESO_TOTAL_100_1 ~ Gompertz(DDS_100_1, y0, ymax, k, lag),
             data=masa_seca_100_1,
             start = list(y0=15, ymax=2500, k=10, lag=1))

masa_seca_66_1 <- datos_masa_seca %>%
  filter(VARIEDAD =="1",TRATAMIENTO.=="66% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_66_1=PESO_TOTAL,
            DDS_66_1=DDS,
            TRATAMIENTO=TRATAMIENTO.)

Gomp_66_1 <- nls(PESO_TOTAL_66_1 ~ Gompertz(DDS_66_1, y0, ymax, k, lag),
             data=masa_seca_66_1,
             start = list(y0=31, ymax=2100, k=15, lag=1))

masa_seca_33_1 <- datos_masa_seca %>%
  filter(VARIEDAD =="1",TRATAMIENTO.=="33% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_33_1=PESO_TOTAL,
            DDS_33_1=DDS,
            TRATAMIENTO=TRATAMIENTO.)

Gomp_33_1 <- nls(PESO_TOTAL_33_1 ~ Gompertz(DDS_33_1, y0, ymax, k, lag),
             data=masa_seca_33_1,
             start = list(y0=21, ymax=2200, k=15, lag=1))

masa_seca_0_1 <- datos_masa_seca %>%
  filter(VARIEDAD =="1",TRATAMIENTO.=="0% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_0_1=PESO_TOTAL,
            DDS_0_1=DDS,
            TRATAMIENTO=TRATAMIENTO.)

Gomp_0_1 <- nls(PESO_TOTAL_0_1 ~ Gompertz(DDS_0_1, y0, ymax, k, lag),
             data=masa_seca_0_1,
             start = list(y0=-7, ymax=1700, k=10, lag=1))
```

Ahora, podemos determinar los parámetros que describen los modelos calculados para cada uno de los tratamientos.

```{r}
coefs_100_1 <- coef(Gomp_100_1)
y0_100_1 = coefs_100_1[1]
ymax_100_1=coefs_100_1[2]
k_100_1=coefs_100_1[3]
lag_100_1=coefs_100_1[4]

coefs_100_1

coefs_66_1 <- coef(Gomp_66_1)
y0_66_1 = coefs_66_1[1]
ymax_66_1=coefs_66_1[2]
k_66_1=coefs_66_1[3]
lag_66_1=coefs_66_1[4]

coefs_66_1

coefs_33_1 <- coef(Gomp_33_1)
y0_33_1 = coefs_33_1[1]
ymax_33_1=coefs_33_1[2]
k_33_1=coefs_33_1[3]
lag_33_1=coefs_33_1[4]

coefs_33_1

coefs_0_1 <- coef(Gomp_0_1)
y0_0_1 = coefs_0_1[1]
ymax_0_1= coefs_0_1[2]
k_0_1 = coefs_0_1[3]
lag_0_1 = coefs_0_1[4]

coefs_0_1
```

Y finalmente, podemos determinar la significancia de cada estimador

```{r}
summary(Gomp_100_1)
summary(Gomp_66_1)
summary(Gomp_33_1)
summary(Gomp_0_1)
```

Por último, para cada modelo, realizamos un gráfico en el que se muestren los puntos originales, y una curva con los puntos que predice el modelo, para cada día desde el día 0 hasta el día 150, el cual es genéricamente el final del ciclo productivo de estos cultivos.

```{r}
DDS_LEVELS <- seq(0,150,by=1)

par(mfrow=c(2,2))

pred <- predict(Gomp_100_1, list(x=DDS_LEVELS))
plot(PESO_TOTAL_100_1~DDS_100_1, data=masa_seca_100_1, xlim=c(0,150), ylim=c(0,2600),
     xlab="DDS", ylab="Peso total (g)")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_100_1, ymax_100_1, k_100_1, lag_100_1),
      lty=1, col="cadetblue3", lwd = 2)

pred <- predict(Gomp_66_1, list(x=DDS_LEVELS))
plot(PESO_TOTAL_66_1~DDS_66_1, data=masa_seca_66_1, xlim=c(0,150), ylim=c(0,2600),
     xlab="DDS", ylab="Peso total (g)")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_66_1, ymax_66_1, k_66_1, lag_66_1),
      lty=1, col="cadetblue2", lwd = 2)

pred <- predict(Gomp_33_1, list(x=DDS_LEVELS))
plot(PESO_TOTAL_33_1~DDS_33_1, data=masa_seca_33_1, xlim=c(0,150), ylim=c(0,2600),
     xlab="DDS", ylab="Peso total (g)")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_33_1, ymax_33_1, k_33_1, lag_33_1),
      lty=1, col="cadetblue4", lwd = 2)

pred <- predict(Gomp_0_1, list(x=DDS_LEVELS))
plot(PESO_TOTAL_0_1~DDS_0_1, data=masa_seca_0_1, xlim=c(0,150), ylim=c(0,2600),
     xlab="DDS", ylab="Peso total (g)")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_0_1, ymax_0_1, k_0_1, lag_0_1),
      lty=1, col="seagreen2", lwd = 2)

par(mfrow=c(1,1))

plot(PESO_TOTAL~DDS, data=masa_seca_1, xlim=c(0,150), ylim=c(0,2600),
     xlab="DDS", ylab="Peso total (g)")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_100_1, ymax_100_1, k_100_1, lag_100_1),
      lty=1, col="cadetblue3", lwd = 2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_66_1, ymax_66_1, k_66_1, lag_66_1),
      lty=1, col="cadetblue2", lwd = 2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_33_1, ymax_33_1, k_33_1, lag_33_1),
      lty=1, col="cadetblue4", lwd = 2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_0_1, ymax_0_1, k_0_1, lag_0_1),
      lty=1, col="seagreen2", lwd = 2)
legend("topleft",legend=c("100% Fertilización", "66% Fertilización", "33% Fertilización", "0% Fertilización"), lwd = 3, col = c("cadetblue3","cadetblue2","cadetblue4","seagreen2"))
```

Ahora, con estos modelos, podemos determinar la acumulación de biomasa para un día de interés. Esto se ha realizado debido a que a la empresa le interezaba correlacionar estos valores modelados, con valores de contenido en savia que se tenían para fechas distintas.

```{r}
pesos_savia_100_1 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_100_1,ymax_100_1,k_100_1,lag_100_1)
DDS_100_1 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_100_1 <- rep("100% Fertilización",11)
Tabla_pesos_savia_100_1 <- data.frame(pesos_savia_100_1,DDS_100_1,TRATAMIENTO_100_1)
Tabla_pesos_savia_100_1

pesos_savia_66_1 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_66_1,ymax_66_1,k_66_1,lag_66_1)
DDS_66_1 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_66_1 <- rep("66% Fertilización",11)
Tabla_pesos_savia_66_1 <- data.frame(pesos_savia_66_1,DDS_66_1,TRATAMIENTO_66_1)
Tabla_pesos_savia_66_1

pesos_savia_33_1 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_33_1,ymax_33_1,k_33_1,lag_33_1)
DDS_33_1 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_33_1 <- rep("33% Fertilización",11)
Tabla_pesos_savia_33_1 <- data.frame(pesos_savia_33_1,DDS_33_1,TRATAMIENTO_33_1)
Tabla_pesos_savia_33_1

pesos_savia_0_1 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_0_1,ymax_0_1,k_0_1,lag_0_1)
DDS_0_1 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_0_1 <- rep("0% Fertilización",11)
Tabla_pesos_savia_0_1 <- data.frame(pesos_savia_0_1,DDS_0_1,TRATAMIENTO_0_1)
Tabla_pesos_savia_0_1
```

### VARIEDAD 39

```{r}
masa_seca_39 <- datos_masa_seca %>% 
  filter(VARIEDAD=="39")%>%
  group_by(DDS,TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_39=mean(PESO_TOTAL,na.rm = T),
            DDS_39=DDS,
            TRATAMIENTO_39=TRATAMIENTO.)

ggplot() + geom_point(data=masa_seca_39, aes(x=DDS, y = PESO_TOTAL_39, group = TRATAMIENTO., colour = TRATAMIENTO.)) + 
  xlab("DDS") + 
  ylab("PESO TOTAL") + 
  ggtitle("") +
  tema
```

```{r}
Gompertz <- function(x, y0, ymax, k, lag){
  result<- y0 + ymax*exp(-exp(k*(lag-x)/(ymax-y0) + 1))
  return(result)
}

masa_seca_100_39 <- datos_masa_seca %>%
  filter(VARIEDAD =="39",TRATAMIENTO.=="100% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_100_39=PESO_TOTAL,
            DDS_100_39=DDS,
            TRATAMIENTO_39=TRATAMIENTO.)

Gomp_100_39 <- nls(PESO_TOTAL_100_39 ~ Gompertz(DDS_100_39, y0, ymax, k, lag),
             data=masa_seca_100_39,
             start = list(y0=20, ymax=2500, k=15, lag=1))

masa_seca_66_39 <- datos_masa_seca %>%
  filter(VARIEDAD =="39",TRATAMIENTO.=="66% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_66_39=PESO_TOTAL,
            DDS_66_39=DDS,
            TRATAMIENTO_39=TRATAMIENTO.)

Gomp_66_39 <- nls(PESO_TOTAL_66_39 ~ Gompertz(DDS_66_39, y0, ymax, k, lag),
             data=masa_seca_66_39,
             start = list(y0=27, ymax=2000, k=15, lag=1))

masa_seca_33_39 <- datos_masa_seca %>%
  filter(VARIEDAD =="39",TRATAMIENTO.=="33% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_33_39=PESO_TOTAL,
            DDS_33_39=DDS,
            TRATAMIENTO_39=TRATAMIENTO.)

Gomp_33_39 <- nls(PESO_TOTAL_33_39 ~ Gompertz(DDS_33_39, y0, ymax, k, lag),
             data=masa_seca_33_39,
             start = list(y0=15, ymax=1500, k=15, lag=1))

masa_seca_0_39 <- datos_masa_seca %>%
  filter(VARIEDAD =="39",TRATAMIENTO.=="0% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_0_39=PESO_TOTAL,
            DDS_0_39=DDS,
            TRATAMIENTO_39=TRATAMIENTO.)

Gomp_0_39 <- nls(PESO_TOTAL_0_39 ~ Gompertz(DDS_0_39, y0, ymax, k, lag),
             data=masa_seca_0_39,
             start = list(y0=10, ymax=1400, k=15, lag=1))
```

```{r}
coefs_100_39 <- coef(Gomp_100_39)
y0_100_39 = coefs_100_39[1]
ymax_100_39=coefs_100_39[2]
k_100_39=coefs_100_39[3]
lag_100_39=coefs_100_39[4]

coefs_100_39

coefs_66_39 <- coef(Gomp_66_39)
y0_66_39 = coefs_66_39[1]
ymax_66_39=coefs_66_39[2]
k_66_39=coefs_66_39[3]
lag_66_39=coefs_66_39[4]

coefs_66_39

coefs_33_39 <- coef(Gomp_33_39)
y0_33_39 = coefs_33_39[1]
ymax_33_39=coefs_33_39[2]
k_33_39=coefs_33_39[3]
lag_33_39=coefs_33_39[4]

coefs_33_39

coefs_0_39 <- coef(Gomp_0_39)
y0_0_39 = coefs_0_39[1]
ymax_0_39=coefs_0_39[2]
k_0_39=coefs_0_39[3]
lag_0_39=coefs_0_39[4]

coefs_0_39
```

```{r}
DDS_LEVELS <- seq(0,150,by=1)

par(mfrow=c(2,2))

pred <- predict(Gomp_100_39, list(x=DDS_LEVELS))
plot(PESO_TOTAL_100_39~DDS_100_39, data=masa_seca_100_39, xlim=c(0,150), ylim=c(0,3000),
     xlab="DDS", ylab="Peso total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_100_39, ymax_100_39, k_100_39, lag_100_39),
      lty=1, col="cadetblue3", lwd = 2)

pred <- predict(Gomp_66_39, list(x=DDS_LEVELS))
plot(PESO_TOTAL_66_39~DDS_66_39, data=masa_seca_66_39, xlim=c(0,150), ylim=c(0,3000),
     xlab="DDS", ylab="Peso total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_66_39, ymax_66_39, k_66_39, lag_66_39),
      lty=1, col="cadetblue2", lwd = 2)

pred <- predict(Gomp_33_39, list(x=DDS_LEVELS))
plot(PESO_TOTAL_33_39~DDS_33_39, data=masa_seca_33_39, xlim=c(0,150), ylim=c(0,3000),
     xlab="DDS", ylab="Peso total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_33_39, ymax_33_39, k_33_39, lag_33_39),
      lty=1, col="cadetblue4", lwd = 2)

pred <- predict(Gomp_0_39, list(x=DDS_LEVELS))
plot(PESO_TOTAL_0_39~DDS_0_39, data=masa_seca_0_39, xlim=c(0,150), ylim=c(0,3000),
     xlab="DDS", ylab="Peso total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_0_39, ymax_0_39, k_0_39, lag_0_39),
      lty=1, col="seagreen2", lwd = 2)

par(mfrow=c(1,1))

plot(PESO_TOTAL_39~DDS, data=masa_seca_39, xlim=c(0,150), ylim=c(0,3000),
     xlab="DDS", ylab="Peso total (g)")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_100_39, ymax_100_39, k_100_39, lag_100_39),
      lty=1, col="cadetblue3", lwd = 2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_66_39, ymax_66_39, k_66_39, lag_66_39),
      lty=1, col="cadetblue2", lwd = 2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_33_39, ymax_33_39, k_33_39, lag_33_39),
      lty=1, col="cadetblue4", lwd = 2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_0_39, ymax_0_39, k_0_39, lag_0_39),
      lty=1, col="seagreen2", lwd = 2)
legend("topleft", legend=c("100% Fertilización", "66% Fertilización", "33% Fertilización", "0% Fertilización"), lwd = 3, col = c("cadetblue3","cadetblue2","cadetblue4","seagreen2"))
```

```{r}
pesos_savia_100_39 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_100_39,ymax_100_39,k_100_39,lag_100_39)
DDS_100_39 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_100_39 <- rep("100% Fertilización",11)
Tabla_pesos_savia_100_39 <- data.frame(pesos_savia_100_39,DDS_100_39,TRATAMIENTO_100_39)
Tabla_pesos_savia_100_39

pesos_savia_66_39 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_66_39,ymax_66_39,k_66_39,lag_66_39)
DDS_66_39 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_66_39 <- rep("66% Fertilización",11)
Tabla_pesos_savia_66_39 <- data.frame(pesos_savia_66_39,DDS_66_39,TRATAMIENTO_66_39)
Tabla_pesos_savia_66_39

pesos_savia_33_39 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_33_39,ymax_33_39,k_33_39,lag_33_39)
DDS_33_39 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_33_39 <- rep("33% Fertilización",11)
Tabla_pesos_savia_33_39 <- data.frame(pesos_savia_33_39,DDS_33_39,TRATAMIENTO_33_39)
Tabla_pesos_savia_33_39

pesos_savia_0_39 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_0_39,ymax_0_39,k_0_39,lag_0_39)
DDS_0_39 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_0_39 <- rep("0% Fertilización",11)
Tabla_pesos_savia_0_39 <- data.frame(pesos_savia_0_39,DDS_0_39,TRATAMIENTO_0_39)
Tabla_pesos_savia_0_39
```

### VARIEDAD 102

```{r}
masa_seca_102 <- datos_masa_seca %>% 
  filter(VARIEDAD=="102")%>%
  group_by(DDS,TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_102=mean(PESO_TOTAL,na.rm = T),
            DDS_102=DDS,
            TRATAMIENTO_102=TRATAMIENTO.)

ggplot() + geom_point(data=masa_seca_102, aes(x=DDS_102, y = PESO_TOTAL_102, group = TRATAMIENTO., colour = TRATAMIENTO.)) + 
  xlab("DDS") + 
  ylab("PESO TOTAL") + 
  ylim(c(0,3000))
  ggtitle("") +
  tema
```

```{r}
Gompertz <- function(x, y0, ymax, k, lag){
  result<- y0 + ymax*exp(-exp(k*(lag-x)/(ymax-y0) + 1))
  return(result)
}

masa_seca_100_102 <- datos_masa_seca %>%
  filter(VARIEDAD =="102",TRATAMIENTO.=="100% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_100_102=PESO_TOTAL,
            DDS_100_102=DDS,
            TRATAMIENTO_102=TRATAMIENTO.)

Gomp_100_102 <- lm(PESO_TOTAL_100_102~DDS_100_102,
             data=masa_seca_100_102)

masa_seca_66_102 <- datos_masa_seca %>%
  filter(VARIEDAD =="102",TRATAMIENTO.=="66% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_66_102=PESO_TOTAL,
            DDS_66_102=DDS,
            TRATAMIENTO=TRATAMIENTO.)

Gomp_66_102 <- nls(PESO_TOTAL_66_102 ~ Gompertz(DDS_66_102, y0, ymax, k, lag),
             data=masa_seca_66_102,
             start = list(y0=20, ymax=3000, k=15, lag=1))

masa_seca_33_102 <- datos_masa_seca %>%
  filter(VARIEDAD =="102",TRATAMIENTO.=="33% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_33_102=PESO_TOTAL,
            DDS_33_102=DDS,
            TRATAMIENTO_102=TRATAMIENTO.)

Gomp_33_102 <- nls(PESO_TOTAL_33_102 ~ Gompertz(DDS_33_102, y0, ymax, k, lag),
             data=masa_seca_33_102,
             start = list(y0=0, ymax=2200, k=15, lag=1))

masa_seca_0_102 <- datos_masa_seca %>%
  filter(VARIEDAD =="102",TRATAMIENTO.=="0% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(PESO_TOTAL_0_102=PESO_TOTAL,
            DDS_0_102=DDS,
            TRATAMIENTO_102=TRATAMIENTO.)

Gomp_0_102 <- nls(PESO_TOTAL_0_102 ~ Gompertz(DDS_0_102, y0, ymax, k, lag),
             data=masa_seca_0_102,
             start = list(y0=20, ymax=1700, k=10, lag=1))
```

```{r}
coefs_100_102 <- coef(Gomp_100_102)
b_100_102 = coefs_100_102[1]
m_100_102=coefs_100_102[2]

coefs_100_102

coefs_66_102 <- coef(Gomp_66_102)
y0_66_102 = coefs_66_102[1]
ymax_66_102=coefs_66_102[2]
k_66_102=coefs_66_102[3]
lag_66_102=coefs_66_102[4]

coefs_66_102

coefs_33_102 <- coef(Gomp_33_102)
y0_33_102 = coefs_33_102[1]
ymax_33_102=coefs_33_102[2]
k_33_102=coefs_33_102[3]
lag_33_102=coefs_33_102[4]

coefs_33_102

coefs_0_102 <- coef(Gomp_0_102)
y0_0_102 = coefs_0_102[1]
ymax_0_102=coefs_0_102[2]
k_0_102=coefs_0_102[3]
lag_0_102=coefs_0_102[4]

coefs_0_102
```

```{r}
DDS_LEVELS <- seq(0,150,by=1)

par(mfrow=c(2,2))

plot(PESO_TOTAL_100_102~DDS_100_102, data=masa_seca_100_102, xlim=c(0,150), ylim=c(0,3000),
     xlab="DDS", ylab="Peso total")
abline(Gomp_100_102, col = "cadetblue3")

pred <- predict(Gomp_66_102, list(x=DDS_LEVELS))
plot(PESO_TOTAL_66_102~DDS_66_102, data=masa_seca_66_102, xlim=c(0,150), ylim=c(0,3000),
     xlab="DDS", ylab="Peso total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_66_102, ymax_66_102, k_66_102, lag_66_102),
      lty=1, col="cadetblue2")

pred <- predict(Gomp_33_102, list(x=DDS_LEVELS))
plot(PESO_TOTAL_33_102~DDS_33_102, data=masa_seca_33_102, xlim=c(0,150), ylim=c(0,3000),
     xlab="DDS", ylab="Peso total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_33_102, ymax_33_102, k_33_102, lag_33_102),
      lty=1, col="cadetblue4")

pred <- predict(Gomp_0_102, list(x=DDS_LEVELS))
plot(PESO_TOTAL_0_102~DDS_0_102, data=masa_seca_0_102, xlim=c(0,150), ylim=c(0,3000),
     xlab="DDS", ylab="Peso total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_0_102, ymax_0_102, k_0_102, lag_0_102),
      lty=1, col="seagreen2")

par(mfrow=c(1,1))

plot(PESO_TOTAL_102~DDS, data=masa_seca_102, xlim=c(0,150), ylim=c(0,3000),
     xlab="DDS", ylab="Peso total (g)")
abline(Gomp_100_102, col = "cadetblue3", lwd = 2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_66_102, ymax_66_102, k_66_102, lag_66_102),
      lty=1, col="cadetblue2", lwd = 2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_33_102, ymax_33_102, k_33_102, lag_33_102),
      lty=1, col="cadetblue4", lwd = 2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_0_102, ymax_0_102, k_0_102, lag_0_102),
      lty=1, col="seagreen2", lwd = 2)
legend("topleft", legend=c("100% Fertilización", "66% Fertilización", "33% Fertilización", "0% Fertilización"), lwd = 3, col = c("cadetblue3","cadetblue2","cadetblue4","seagreen2"))
```

```{r}
pesos_savia_100_102 <- 25.79*(c(36,45,53,61,70,78,84,91,98,105,115))-1258.36
DDS_100_102 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_100_102 <- rep("100% Fertilización",11)
Tabla_pesos_savia_100_102 <- data.frame(pesos_savia_100_102,DDS_100_102,TRATAMIENTO_100_102)
Tabla_pesos_savia_100_102

pesos_savia_66_102 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_66_102,ymax_66_102,k_66_102,lag_66_102)
DDS_66_102 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_66_102 <- rep("66% Fertilización",11)
Tabla_pesos_savia_66_102 <- data.frame(pesos_savia_66_102,DDS_66_102,TRATAMIENTO_66_102)
Tabla_pesos_savia_66_102

pesos_savia_33_102 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_33_102,ymax_33_102,k_33_102,lag_33_102)
DDS_33_102 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_33_102 <- rep("33% Fertilización",11)
Tabla_pesos_savia_33_102 <- data.frame(pesos_savia_33_102,DDS_33_102,TRATAMIENTO_33_102)
Tabla_pesos_savia_33_102

pesos_savia_0_102 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_0_102,ymax_0_102,k_0_102,lag_0_102)
DDS_0_102 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_0_102 <- rep("0% Fertilización",11)
Tabla_pesos_savia_0_102 <- data.frame(pesos_savia_0_102,DDS_0_102,TRATAMIENTO_0_102)
Tabla_pesos_savia_0_102
```

### 3) PESO SECO V.S. CONTENIDO EN SAVIA

En este apartado, se realizará el modelamiento del comportamiento de nutientes en sabia, de acuerdo con los datos obtenidos a partir del modelo de gompertz para la acumulación de masa seca. Igualmente, se realiza independiente para cada elemento y variedad, con el fin de tener claridad sobre la información.

# NO3

# CPI 1

Iniciamos generando los dataframes requeridos, concatenando la infromación ya modelada a partir de la función de gompertz, con los datos preexistentes sobre contenido en savia.

```{r}
mccain_savia_0_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_0_1 <- cbind(mccain_savia_0_1$Variedad,Tabla_pesos_savia_0_1, mccain_savia_0_1$NO3)
colnames(Tabla_0_1) <- c('Variedad','Peso','DDS','Tratamiento','NO3')

mccain_savia_33_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_33_1 <- cbind(mccain_savia_33_1$Variedad,Tabla_pesos_savia_33_1, mccain_savia_33_1$NO3)
colnames(Tabla_33_1) <- c('Variedad','Peso','DDS','Tratamiento','NO3')

mccain_savia_66_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_66_1 <- cbind(mccain_savia_66_1$Variedad,Tabla_pesos_savia_66_1, mccain_savia_66_1$NO3)
colnames(Tabla_66_1) <- c('Variedad','Peso','DDS','Tratamiento','NO3')

mccain_savia_100_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_100_1 <- cbind(mccain_savia_100_1$Variedad,Tabla_pesos_savia_100_1, mccain_savia_100_1$NO3)
colnames(Tabla_100_1) <- c('Variedad','Peso','DDS','Tratamiento','NO3')

Tabla_1 <- rbind(Tabla_0_1,Tabla_33_1, Tabla_66_1, Tabla_100_1)

Tabla_1
```

# CIP 39

```{r}
mccain_savia_0_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_0_39 <- cbind(mccain_savia_0_39$Variedad,Tabla_pesos_savia_0_39, mccain_savia_0_39$NO3)
colnames(Tabla_0_39) <- c('Variedad','Peso','DDS','Tratamiento','NO3')

mccain_savia_33_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_33_39 <- cbind(mccain_savia_33_39$Variedad,Tabla_pesos_savia_33_39, mccain_savia_33_39$NO3)
colnames(Tabla_33_39) <- c('Variedad','Peso','DDS','Tratamiento','NO3')

mccain_savia_66_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_66_39 <- cbind(mccain_savia_66_39$Variedad,Tabla_pesos_savia_66_39, mccain_savia_66_39$NO3)
colnames(Tabla_66_39) <- c('Variedad','Peso','DDS','Tratamiento','NO3')

mccain_savia_100_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_100_39 <- cbind(mccain_savia_100_39$Variedad,Tabla_pesos_savia_100_39, mccain_savia_100_39$NO3)
colnames(Tabla_100_39) <- c('Variedad','Peso','DDS','Tratamiento','NO3')

Tabla_39 <- rbind(Tabla_0_39,Tabla_33_39, Tabla_66_39, Tabla_100_39)

Tabla_39
```

# CIP 102

```{r}
mccain_savia_0_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_0_102 <- cbind(mccain_savia_0_102$Variedad,Tabla_pesos_savia_0_102, mccain_savia_0_102$NO3)
colnames(Tabla_0_102) <- c('Variedad','Peso','DDS','Tratamiento','NO3')

mccain_savia_33_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_33_102 <- cbind(mccain_savia_33_102$Variedad,Tabla_pesos_savia_33_102, mccain_savia_33_102$NO3)
colnames(Tabla_33_102) <- c('Variedad','Peso','DDS','Tratamiento','NO3')

mccain_savia_66_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_66_102 <- cbind(mccain_savia_66_102$Variedad,Tabla_pesos_savia_66_102, mccain_savia_66_102$NO3)
colnames(Tabla_66_102) <- c('Variedad','Peso','DDS','Tratamiento','NO3')

mccain_savia_100_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_100_102 <- cbind(mccain_savia_100_102$Variedad,Tabla_pesos_savia_100_102, mccain_savia_100_102$NO3)
colnames(Tabla_100_102) <- c('Variedad','Peso','DDS','Tratamiento','NO3')

Tabla_102 <- rbind(Tabla_0_102,Tabla_33_102, Tabla_66_102, Tabla_100_102)

Tabla_102
```

Con esto, ya podemos generar gráficos, presentando información del comportamiento de nutrientes, y la acumulación de biomasa.

# Gráficos

```{r}
NO3CPI1 <-  Tabla_1%>%
  group_by(DDS,Tratamiento)%>%
  summarise(NITRATO=mean(NO3,na.rm=T),
            PESO=Peso,
            TRATAMIENTO=Tratamiento,
            SE=sd(NO3,na.rm=T)/sqrt(length(complete.cases(NO3))))

ggplot(NO3CPI1,aes(x=PESO, y=NITRATO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,10000,500))+
  scale_x_continuous(breaks=seq(0,2000,200))+
  labs(title="Nitrato en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 1", x="Peso seco (g)", y="Contenido de nitrato (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema

NO3CPI39 <-  Tabla_39%>%
  group_by(DDS,Tratamiento)%>%
  summarise(NITRATO=mean(NO3,na.rm=T),
            PESO=Peso,
            TRATAMIENTO=Tratamiento,
            SE=sd(NO3,na.rm=T)/sqrt(length(complete.cases(NO3))))

ggplot(NO3CPI39,aes(x=PESO, y=NITRATO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,10000,500))+
  scale_x_continuous(breaks=seq(0,2000,200))+
  labs(title="Nitrato en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 39", x="Peso seco (g)", y="Contenido de nitrato (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema

NO3CPI102 <-  Tabla_102%>%
  group_by(DDS,Tratamiento)%>%
  summarise(NITRATO=mean(NO3,na.rm=T),
            PESO=Peso,
            TRATAMIENTO=Tratamiento,
            SE=sd(NO3,na.rm=T)/sqrt(length(complete.cases(NO3))))

ggplot(NO3CPI102,aes(x=PESO, y=NITRATO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,10000,500))+
  scale_x_continuous(breaks=seq(0,2000,200))+
  labs(title="Nitrato en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 102", x="Peso seco (g)", y="Contenido de nitrato (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema
```

# Ca

# CPI 1

```{r}
mccain_savia_0_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_0_1 <- cbind(mccain_savia_0_1$Variedad,Tabla_pesos_savia_0_1, mccain_savia_0_1$Ca)
colnames(Tabla_0_1) <- c('Variedad','Peso','DDS','Tratamiento','Ca')

mccain_savia_33_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_33_1 <- cbind(mccain_savia_33_1$Variedad,Tabla_pesos_savia_33_1, mccain_savia_33_1$Ca)
colnames(Tabla_33_1) <- c('Variedad','Peso','DDS','Tratamiento','Ca')

mccain_savia_66_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_66_1 <- cbind(mccain_savia_66_1$Variedad,Tabla_pesos_savia_66_1, mccain_savia_66_1$Ca)
colnames(Tabla_66_1) <- c('Variedad','Peso','DDS','Tratamiento','Ca')

mccain_savia_100_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_100_1 <- cbind(mccain_savia_100_1$Variedad,Tabla_pesos_savia_100_1, mccain_savia_100_1$Ca)
colnames(Tabla_100_1) <- c('Variedad','Peso','DDS','Tratamiento','Ca')

Tabla_1 <- rbind(Tabla_0_1,Tabla_33_1, Tabla_66_1, Tabla_100_1)

Tabla_1
```

# CIP 39

```{r}
mccain_savia_0_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_0_39 <- cbind(mccain_savia_0_39$Variedad,Tabla_pesos_savia_0_39, mccain_savia_0_39$Ca)
colnames(Tabla_0_39) <- c('Variedad','Peso','DDS','Tratamiento','Ca')

mccain_savia_33_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_33_39 <- cbind(mccain_savia_33_39$Variedad,Tabla_pesos_savia_33_39, mccain_savia_33_39$Ca)
colnames(Tabla_33_39) <- c('Variedad','Peso','DDS','Tratamiento','Ca')

mccain_savia_66_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_66_39 <- cbind(mccain_savia_66_39$Variedad,Tabla_pesos_savia_66_39, mccain_savia_66_39$Ca)
colnames(Tabla_66_39) <- c('Variedad','Peso','DDS','Tratamiento','Ca')

mccain_savia_100_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_100_39 <- cbind(mccain_savia_100_39$Variedad,Tabla_pesos_savia_100_39, mccain_savia_100_39$Ca)
colnames(Tabla_100_39) <- c('Variedad','Peso','DDS','Tratamiento','Ca')

Tabla_39 <- rbind(Tabla_0_39,Tabla_33_39, Tabla_66_39, Tabla_100_39)

Tabla_39
```

# CIP 102

```{r}
mccain_savia_0_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_0_102 <- cbind(mccain_savia_0_102$Variedad,Tabla_pesos_savia_0_102, mccain_savia_0_102$Ca)
colnames(Tabla_0_102) <- c('Variedad','Peso','DDS','Tratamiento','Ca')

mccain_savia_33_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_33_102 <- cbind(mccain_savia_33_102$Variedad,Tabla_pesos_savia_33_102, mccain_savia_33_102$Ca)
colnames(Tabla_33_102) <- c('Variedad','Peso','DDS','Tratamiento','Ca')

mccain_savia_66_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_66_102 <- cbind(mccain_savia_66_102$Variedad,Tabla_pesos_savia_66_102, mccain_savia_66_102$Ca)
colnames(Tabla_66_102) <- c('Variedad','Peso','DDS','Tratamiento','Ca')

mccain_savia_100_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_100_102 <- cbind(mccain_savia_100_102$Variedad,Tabla_pesos_savia_100_102, mccain_savia_100_102$Ca)
colnames(Tabla_100_102) <- c('Variedad','Peso','DDS','Tratamiento','Ca')

Tabla_102 <- rbind(Tabla_0_102,Tabla_33_102, Tabla_66_102, Tabla_100_102)

Tabla_102
```

# Gráficos

```{r}
CaCPI1 <-  Tabla_1%>%
  group_by(DDS,Tratamiento)%>%
  summarise(CALCIO=mean(Ca,na.rm=T),
            PESO=Peso,
            TRATAMIENTO=Tratamiento,
            SE=sd(Ca,na.rm=T)/sqrt(length(complete.cases(Ca))))

ggplot(CaCPI1,aes(x=PESO, y=CALCIO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  labs(title="Calcio en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 1", x="Peso seco (g)", y="Contenido de calcio (ppm)")+
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,20,1))+
  scale_x_continuous(breaks=seq(0,2000,200))+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema

CaCPI39 <-  Tabla_39%>%
  group_by(DDS,Tratamiento)%>%
  summarise(CALCIO=mean(Ca,na.rm=T),
            PESO=Peso,
            TRATAMIENTO=Tratamiento,
            SE=sd(Ca,na.rm=T)/sqrt(length(complete.cases(Ca))))

ggplot(CaCPI39,aes(x=PESO, y=CALCIO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  labs(title="Calcio en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 39", x="Peso seco (g)", y="Contenido de calcio (ppm)")+
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,20,2))+
  scale_x_continuous(breaks=seq(0,152000,200))+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema

CaCPI102 <-  Tabla_102%>%
  group_by(DDS,Tratamiento)%>%
  summarise(CALCIO=mean(Ca,na.rm=T),
            PESO=Peso,
            TRATAMIENTO=Tratamiento,
            SE=sd(Ca,na.rm=T)/sqrt(length(complete.cases(Ca))))

ggplot(CaCPI102,aes(x=PESO, y=CALCIO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,5,0.01))+
  scale_x_continuous(breaks=seq(0,2000,200))+
  labs(title="Calcio en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 102", x="Peso seco (g)", y="Contenido de calcio (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema
```

# K

# CPI 1

```{r}
mccain_savia_0_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_0_1 <- cbind(mccain_savia_0_1$Variedad,Tabla_pesos_savia_0_1, mccain_savia_0_1$K)
colnames(Tabla_0_1) <- c('Variedad','Peso','DDS','Tratamiento','K')

mccain_savia_33_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_33_1 <- cbind(mccain_savia_33_1$Variedad,Tabla_pesos_savia_33_1, mccain_savia_33_1$K)
colnames(Tabla_33_1) <- c('Variedad','Peso','DDS','Tratamiento','K')

mccain_savia_66_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_66_1 <- cbind(mccain_savia_66_1$Variedad,Tabla_pesos_savia_66_1, mccain_savia_66_1$K)
colnames(Tabla_66_1) <- c('Variedad','Peso','DDS','Tratamiento','K')

mccain_savia_100_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_100_1 <- cbind(mccain_savia_100_1$Variedad,Tabla_pesos_savia_100_1, mccain_savia_100_1$K)
colnames(Tabla_100_1) <- c('Variedad','Peso','DDS','Tratamiento','K')

Tabla_1 <- rbind(Tabla_0_1,Tabla_33_1, Tabla_66_1, Tabla_100_1)

Tabla_1
```

# CIP 39

```{r}
mccain_savia_0_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_0_39 <- cbind(mccain_savia_0_39$Variedad,Tabla_pesos_savia_0_39, mccain_savia_0_39$K)
colnames(Tabla_0_39) <- c('Variedad','Peso','DDS','Tratamiento','K')

mccain_savia_33_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_33_39 <- cbind(mccain_savia_33_39$Variedad,Tabla_pesos_savia_33_39, mccain_savia_33_39$K)
colnames(Tabla_33_39) <- c('Variedad','Peso','DDS','Tratamiento','K')

mccain_savia_66_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_66_39 <- cbind(mccain_savia_66_39$Variedad,Tabla_pesos_savia_66_39, mccain_savia_66_39$K)
colnames(Tabla_66_39) <- c('Variedad','Peso','DDS','Tratamiento','K')

mccain_savia_100_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_100_39 <- cbind(mccain_savia_100_39$Variedad,Tabla_pesos_savia_100_39, mccain_savia_100_39$K)
colnames(Tabla_100_39) <- c('Variedad','Peso','DDS','Tratamiento','K')

Tabla_39 <- rbind(Tabla_0_39,Tabla_33_39, Tabla_66_39, Tabla_100_39)

Tabla_39
```

# CIP 102

```{r}
mccain_savia_0_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_0_102 <- cbind(mccain_savia_0_102$Variedad,Tabla_pesos_savia_0_102, mccain_savia_0_102$K)
colnames(Tabla_0_102) <- c('Variedad','Peso','DDS','Tratamiento','K')

mccain_savia_33_102 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_33_102 <- cbind(mccain_savia_33_102$Variedad,Tabla_pesos_savia_33_102, mccain_savia_33_102$K)
colnames(Tabla_33_102) <- c('Variedad','Peso','DDS','Tratamiento','K')

mccain_savia_66_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_66_102 <- cbind(mccain_savia_66_102$Variedad,Tabla_pesos_savia_66_102, mccain_savia_66_102$K)
colnames(Tabla_66_102) <- c('Variedad','Peso','DDS','Tratamiento','K')

mccain_savia_100_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_100_102 <- cbind(mccain_savia_100_102$Variedad,Tabla_pesos_savia_100_102, mccain_savia_100_102$K)
colnames(Tabla_100_102) <- c('Variedad','Peso','DDS','Tratamiento','K')

Tabla_102 <- rbind(Tabla_0_102,Tabla_33_102, Tabla_66_102, Tabla_100_102)

Tabla_102
```

# Gráficos

```{r}
KCPI1 <-  Tabla_1%>%
  group_by(DDS,Tratamiento)%>%
  summarise(POTASIO=mean(K,na.rm=T),
            PESO=Peso,
            TRATAMIENTO=Tratamiento,
            SE=sd(K,na.rm=T)/sqrt(length(complete.cases(K))))

ggplot(KCPI1,aes(x=PESO, y=POTASIO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,10000,500))+
  scale_x_continuous(breaks=seq(0,2000,200))+
  labs(title="Potasio en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 1", x="Peso seco (g)", y="Contenido de potasio (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema

KCPI39 <-  Tabla_39%>%
  group_by(DDS,Tratamiento)%>%
  summarise(POTASIO=mean(K,na.rm=T),
            PESO=Peso,
            TRATAMIENTO=Tratamiento,
            SE=sd(K,na.rm=T)/sqrt(length(complete.cases(K))))

ggplot(KCPI39,aes(x=PESO, y=POTASIO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,10000,500))+
  scale_x_continuous(breaks=seq(0,2000,200))+
  labs(title="Potasio en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 39", x="Peso seco (g)", y="Contenido de potasio (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema

KCPI102 <-  Tabla_102%>%
  group_by(DDS,Tratamiento)%>%
  summarise(POTASIO=mean(K,na.rm=T),
            PESO=Peso,
            TRATAMIENTO=Tratamiento,
            SE=sd(K,na.rm=T)/sqrt(length(complete.cases(K))))

ggplot(KCPI102,aes(x=PESO, y=POTASIO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,10000,500))+
  scale_x_continuous(breaks=seq(0,2000,200))+
  labs(title="Potasio en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 102", x="Peso seco (g)", y="Contenido de potasio (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema
```

### 4) MODELO RENDIMIENTO

### VARIEDAD 1

```{r}
library(dplyr)

masa_seca_1 <- datos_masa_seca %>% 
  filter(VARIEDAD=="1")%>%
  group_by(DDS,TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA=mean(REND_TUB_TON_HA,na.rm = T),
            DDS=DDS,
            TRATAMIENTO=TRATAMIENTO.)


ggplot() + geom_point(data=masa_seca_1, aes(x=DDS, y = REND_TUB_TON_HA, group = TRATAMIENTO., colour = TRATAMIENTO.)) + 
  xlab("DDS") + 
  ylab("RENDIMIENTO TOTAL") + 
  ggtitle("") +
  tema
```

```{r}
Gompertz <- function(x, y0, ymax, k, lag){
  result<- y0 + ymax*exp(-exp(k*(lag-x)/(ymax-y0) + 1))
  return(result)
}

masa_seca_100_1 <- datos_masa_seca %>%
  filter(VARIEDAD =="1",TRATAMIENTO.=="100% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_100_1=REND_TUB_TON_HA,
            DDS_100_1=DDS,
            TRATAMIENTO=TRATAMIENTO.)

Gomp_100_1 <- nls(REND_TUB_TON_HA_100_1 ~ Gompertz(DDS_100_1, y0, ymax, k, lag),
             data=masa_seca_100_1,
             start = list(y0=1, ymax=30, k=0.1, lag=1))

masa_seca_66_1 <- datos_masa_seca %>%
  filter(VARIEDAD =="1",TRATAMIENTO.=="66% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_66_1=REND_TUB_TON_HA,
            DDS_66_1=DDS,
            TRATAMIENTO=TRATAMIENTO.)

Gomp_66_1 <- nls(REND_TUB_TON_HA_66_1 ~ Gompertz(DDS_66_1, y0, ymax, k, lag),
             data=masa_seca_66_1,
             start = list(y0=1, ymax=30, k=0.1, lag=1))

masa_seca_33_1 <- datos_masa_seca %>%
  filter(VARIEDAD =="1",TRATAMIENTO.=="33% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_33_1=REND_TUB_TON_HA,
            DDS_33_1=DDS,
            TRATAMIENTO=TRATAMIENTO.)

Gomp_33_1 <- nls(REND_TUB_TON_HA_33_1 ~ Gompertz(DDS_33_1, y0, ymax, k, lag),
             data=masa_seca_33_1,
             start = list(y0=1, ymax=30, k=0.1, lag=1))

masa_seca_0_1 <- datos_masa_seca %>%
  filter(VARIEDAD =="1",TRATAMIENTO.=="0% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_0_1=REND_TUB_TON_HA,
            DDS_0_1=DDS,
            TRATAMIENTO=TRATAMIENTO.)

Gomp_0_1 <- nls(REND_TUB_TON_HA_0_1 ~ Gompertz(DDS_0_1, y0, ymax, k, lag),
             data=masa_seca_0_1,
             start = list(y0=1, ymax=30, k=0.1, lag=1))
```

```{r}
coefs_100_1 <- coef(Gomp_100_1)
y0_100_1 = coefs_100_1[1]
ymax_100_1=coefs_100_1[2]
k_100_1=coefs_100_1[3]
lag_100_1=coefs_100_1[4]

coefs_100_1

coefs_66_1 <- coef(Gomp_66_1)
y0_66_1 = coefs_66_1[1]
ymax_66_1=coefs_66_1[2]
k_66_1=coefs_66_1[3]
lag_66_1=coefs_66_1[4]

coefs_66_1

coefs_33_1 <- coef(Gomp_33_1)
y0_33_1 = coefs_33_1[1]
ymax_33_1=coefs_33_1[2]
k_33_1=coefs_33_1[3]
lag_33_1=coefs_33_1[4]

coefs_33_1

coefs_0_1 <- coef(Gomp_0_1)
y0_0_1 = coefs_0_1[1]
ymax_0_1= coefs_0_1[2]
k_0_1 = coefs_0_1[3]
lag_0_1 = coefs_0_1[4]

coefs_0_1
```

```{r}
DDS_LEVELS <- seq(0,150,by=1)

par(mfrow=c(2,2))

pred <- predict(Gomp_100_1, list(x=DDS_LEVELS))
plot(REND_TUB_TON_HA_100_1~DDS_100_1, data=masa_seca_100_1, xlim=c(0,150), ylim=c(0,25),
     xlab="DDS", ylab="RENDIMIENTO total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_100_1, ymax_100_1, k_100_1, lag_100_1),
      lty=1, col="cadetblue3", lwd = 2)

pred <- predict(Gomp_66_1, list(x=DDS_LEVELS))
plot(REND_TUB_TON_HA_66_1~DDS_66_1, data=masa_seca_66_1, xlim=c(0,150), ylim=c(0,25),
     xlab="DDS", ylab="RENDIMIENTO total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_66_1, ymax_66_1, k_66_1, lag_66_1),
      lty=1, col="cadetblue2", lwd=2)

pred <- predict(Gomp_33_1, list(x=DDS_LEVELS))
plot(REND_TUB_TON_HA_33_1~DDS_33_1, data=masa_seca_33_1, xlim=c(0,150), ylim=c(0,25),
     xlab="DDS", ylab="RENDIMIENTO total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_33_1, ymax_33_1, k_33_1, lag_33_1),
      lty=1, col="cadetblue4", lwd=2)

pred <- predict(Gomp_0_1, list(x=DDS_LEVELS))
plot(REND_TUB_TON_HA_0_1~DDS_0_1, data=masa_seca_0_1, xlim=c(0,150), ylim=c(0,25),
     xlab="DDS", ylab="RENDIMIENTO total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_0_1, ymax_0_1, k_0_1, lag_0_1),
      lty=1, col="seagreen2", lwd=2)

par(mfrow=c(1,1))

plot(REND_TUB_TON_HA~DDS, data=masa_seca_1, xlim=c(0,150), ylim=c(0,25),
     xlab="DDS", ylab="Rendimiento total (ton/ha)")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_66_1, ymax_66_1, k_66_1, lag_66_1),
      lty=1, col="cadetblue2", lwd=2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_100_1, ymax_100_1, k_100_1, lag_100_1),
      lty=1, col="cadetblue3", lwd=2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_33_1, ymax_33_1, k_33_1, lag_33_1),
      lty=1, col="cadetblue4", lwd=2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_0_1, ymax_0_1, k_0_1, lag_0_1),
      lty=1, col="seagreen2", lwd=2)
legend("topleft", legend=c("100% Fertilización", "66% Fertilización", "33% Fertilización", "0% Fertilización"), lwd = 3, col = c("cadetblue3","cadetblue2","cadetblue4", "seagreen2"))
```

```{r}
RENDIMIENTOs_savia_100_1 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_100_1,ymax_100_1,k_100_1,lag_100_1)
DDS_100_1 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_100_1 <- rep("100% Fertilización",11)
Tabla_RENDIMIENTOs_savia_100_1 <- data.frame(RENDIMIENTOs_savia_100_1,DDS_100_1,TRATAMIENTO_100_1)
Tabla_RENDIMIENTOs_savia_100_1

RENDIMIENTOs_savia_66_1 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_66_1,ymax_66_1,k_66_1,lag_66_1)
DDS_66_1 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_66_1 <- rep("66% Fertilización",11)
Tabla_RENDIMIENTOs_savia_66_1 <- data.frame(RENDIMIENTOs_savia_66_1,DDS_66_1,TRATAMIENTO_66_1)
Tabla_RENDIMIENTOs_savia_66_1

RENDIMIENTOs_savia_33_1 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_33_1,ymax_33_1,k_33_1,lag_33_1)
DDS_33_1 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_33_1 <- rep("33% Fertilización",11)
Tabla_RENDIMIENTOs_savia_33_1 <- data.frame(RENDIMIENTOs_savia_33_1,DDS_33_1,TRATAMIENTO_33_1)
Tabla_RENDIMIENTOs_savia_33_1

RENDIMIENTOs_savia_0_1 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_0_1,ymax_0_1,k_0_1,lag_0_1)
DDS_0_1 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_0_1 <- rep("0% Fertilización",11)
Tabla_RENDIMIENTOs_savia_0_1 <- data.frame(RENDIMIENTOs_savia_0_1,DDS_0_1,TRATAMIENTO_0_1)
Tabla_RENDIMIENTOs_savia_0_1
```

### VARIEDAD 39

```{r}
masa_seca_39 <- datos_masa_seca %>% 
  filter(VARIEDAD=="39")%>%
  group_by(DDS,TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_39=mean(REND_TUB_TON_HA,na.rm = T),
            DDS_39=DDS,
            TRATAMIENTO_39=TRATAMIENTO.)

ggplot() + geom_point(data=masa_seca_39, aes(x=DDS, y = REND_TUB_TON_HA_39, group = TRATAMIENTO., colour = TRATAMIENTO.)) + 
  xlab("DDS") + 
  ylab("RENDIMIENTO TOTAL") + 
  ggtitle("") +
  tema
```

```{r}
Gompertz <- function(x, y0, ymax, k, lag){
  result<- y0 + ymax*exp(-exp(k*(lag-x)/(ymax-y0) + 1))
  return(result)
}

masa_seca_100_39 <- datos_masa_seca %>%
  filter(VARIEDAD =="39",TRATAMIENTO.=="100% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_100_39=REND_TUB_TON_HA,
            DDS_100_39=DDS,
            TRATAMIENTO_39=TRATAMIENTO.)

Gomp_100_39 <- nls(REND_TUB_TON_HA_100_39 ~ Gompertz(DDS_100_39, y0, ymax, k, lag),
             data=masa_seca_100_39,
             start = list(y0=1, ymax=25, k=0.1, lag=1))

masa_seca_66_39 <- datos_masa_seca %>%
  filter(VARIEDAD =="39",TRATAMIENTO.=="66% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_66_39=REND_TUB_TON_HA,
            DDS_66_39=DDS,
            TRATAMIENTO_39=TRATAMIENTO.)

Gomp_66_39 <- nls(REND_TUB_TON_HA_66_39 ~ Gompertz(DDS_66_39, y0, ymax, k, lag),
             data=masa_seca_66_39,
             start = list(y0=1, ymax=25, k=0.1, lag=1))

masa_seca_33_39 <- datos_masa_seca %>%
  filter(VARIEDAD =="39",TRATAMIENTO.=="33% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_33_39=REND_TUB_TON_HA,
            DDS_33_39=DDS,
            TRATAMIENTO_39=TRATAMIENTO.)

Gomp_33_39 <- nls(REND_TUB_TON_HA_33_39 ~ Gompertz(DDS_33_39, y0, ymax, k, lag),
             data=masa_seca_33_39,
             start = list(y0=1, ymax=25, k=0.1, lag=1))

masa_seca_0_39 <- datos_masa_seca %>%
  filter(VARIEDAD =="39",TRATAMIENTO.=="0% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_0_39=REND_TUB_TON_HA,
            DDS_0_39=DDS,
            TRATAMIENTO_39=TRATAMIENTO.)

Gomp_0_39 <- nls(REND_TUB_TON_HA_0_39 ~ Gompertz(DDS_0_39, y0, ymax, k, lag),
             data=masa_seca_0_39,
             start = list(y0=1, ymax=25, k=0.1, lag=1))
```

```{r}
coefs_100_39 <- coef(Gomp_100_39)
y0_100_39 = coefs_100_39[1]
ymax_100_39=coefs_100_39[2]
k_100_39=coefs_100_39[3]
lag_100_39=coefs_100_39[4]

coefs_100_39

coefs_66_39 <- coef(Gomp_66_39)
y0_66_39 = coefs_66_39[1]
ymax_66_39=coefs_66_39[2]
k_66_39=coefs_66_39[3]
lag_66_39=coefs_66_39[4]

coefs_66_39

coefs_33_39 <- coef(Gomp_33_39)
y0_33_39 = coefs_33_39[1]
ymax_33_39=coefs_33_39[2]
k_33_39=coefs_33_39[3]
lag_33_39=coefs_33_39[4]

coefs_33_39

coefs_0_39 <- coef(Gomp_0_39)
y0_0_39 = coefs_0_39[1]
ymax_0_39=coefs_0_39[2]
k_0_39=coefs_0_39[3]
lag_0_39=coefs_0_39[4]

coefs_0_39
```

```{r}
DDS_LEVELS <- seq(0,150,by=1)

par(mfrow=c(2,2))

pred <- predict(Gomp_100_39, list(x=DDS_LEVELS))
plot(REND_TUB_TON_HA_100_39~DDS_100_39, data=masa_seca_100_39, xlim=c(0,150), ylim=c(0,25),
     xlab="DDS", ylab="RENDIMIENTO total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_100_39, ymax_100_39, k_100_39, lag_100_39),
      lty=1, col="cadetblue3", lwd=2)

pred <- predict(Gomp_66_39, list(x=DDS_LEVELS))
plot(REND_TUB_TON_HA_66_39~DDS_66_39, data=masa_seca_66_39, xlim=c(0,150), ylim=c(0,25),
     xlab="DDS", ylab="RENDIMIENTO total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_66_39, ymax_66_39, k_66_39, lag_66_39),
      lty=1, col="cadetblue2", lwd=2)

pred <- predict(Gomp_33_39, list(x=DDS_LEVELS))
plot(REND_TUB_TON_HA_33_39~DDS_33_39, data=masa_seca_33_39, xlim=c(0,150), ylim=c(0,25),
     xlab="DDS", ylab="RENDIMIENTO total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_33_39, ymax_33_39, k_33_39, lag_33_39),
      lty=1, col="cadetblue4", lwd=2)

pred <- predict(Gomp_0_39, list(x=DDS_LEVELS))
plot(REND_TUB_TON_HA_0_39~DDS_0_39, data=masa_seca_0_39, xlim=c(0,150), ylim=c(0,25),
     xlab="DDS", ylab="RENDIMIENTO total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_0_39, ymax_0_39, k_0_39, lag_0_39),
      lty=1, col="seagreen2", lwd=2)

par(mfrow=c(1,1))

plot(REND_TUB_TON_HA_39~DDS_39, data=masa_seca_39, xlim=c(0,150), ylim=c(0,25),
     xlab="DDS", ylab="Rendimiento total")
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_66_39, ymax_66_39, k_66_39, lag_66_39),
      lty=1, col="cadetblue2", lwd=2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_100_39, ymax_100_39, k_100_39, lag_100_39),
      lty=1, col="cadetblue3", lwd=2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_33_39, ymax_33_39, k_33_39, lag_33_39),
      lty=1, col="cadetblue4", lwd=2)
lines(DDS_LEVELS, Gompertz(DDS_LEVELS, y0_0_39, ymax_0_39, k_0_39, lag_0_39),
      lty=1, col="seagreen2", lwd=2)
legend("topleft", legend=c("100% Fertilización", "66% Fertilización", "33% Fertilización", "0% Fertilización"), lwd = 3, col = c("cadetblue3","cadetblue2","cadetblue4", "seagreen2"))
```

```{r}
RENDIMIENTOs_savia_100_39 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_100_39,ymax_100_39,k_100_39,lag_100_39)
DDS_100_39 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_100_39 <- rep("100% Fertilización",11)
Tabla_RENDIMIENTOs_savia_100_39 <- data.frame(RENDIMIENTOs_savia_100_39,DDS_100_39,TRATAMIENTO_100_39)
Tabla_RENDIMIENTOs_savia_100_39

RENDIMIENTOs_savia_66_39 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_66_39,ymax_66_39,k_66_39,lag_66_39)
DDS_66_39 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_66_39 <- rep("66% Fertilización",11)
Tabla_RENDIMIENTOs_savia_66_39 <- data.frame(RENDIMIENTOs_savia_66_39,DDS_66_39,TRATAMIENTO_66_39)
Tabla_RENDIMIENTOs_savia_66_39

RENDIMIENTOs_savia_33_39 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_33_39,ymax_33_39,k_33_39,lag_33_39)
DDS_33_39 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_33_39 <- rep("33% Fertilización",11)
Tabla_RENDIMIENTOs_savia_33_39 <- data.frame(RENDIMIENTOs_savia_33_39,DDS_33_39,TRATAMIENTO_33_39)
Tabla_RENDIMIENTOs_savia_33_39

RENDIMIENTOs_savia_0_39 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_0_39,ymax_0_39,k_0_39,lag_0_39)
DDS_0_39 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_0_39 <- rep("0% Fertilización",11)
Tabla_RENDIMIENTOs_savia_0_39 <- data.frame(RENDIMIENTOs_savia_0_39,DDS_0_39,TRATAMIENTO_0_39)
Tabla_RENDIMIENTOs_savia_0_39
```

### VARIEDAD 102

```{r}
masa_seca_102 <- datos_masa_seca %>% 
  filter(VARIEDAD=="102")%>%
  group_by(DDS,TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_102=mean(REND_TUB_TON_HA,na.rm = T),
            DDS_102=DDS,
            TRATAMIENTO_102=TRATAMIENTO.)

masa_seca_102

ggplot() + geom_point(data=masa_seca_102, aes(x=DDS_102, y = REND_TUB_TON_HA_102, group = TRATAMIENTO., colour = TRATAMIENTO.)) + 
  xlab("DDS") + 
  ylab("RENDIMIENTO TOTAL") + 
  ggtitle("") +
  tema
```

```{r}
Cuadratica <- function(x,y0,a){
  result<- (y0 + a*x^2)
  return(result)
}

masa_seca_100_102 <- datos_masa_seca %>%
  filter(VARIEDAD =="102",TRATAMIENTO.=="100% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_100_102=REND_TUB_TON_HA,
            DDS_100_102=DDS,
            TRATAMIENTO_102=TRATAMIENTO.)

Cuad_100_102 <- nls(REND_TUB_TON_HA_100_102~Cuadratica(DDS_100_102,y0,a),
             data=masa_seca_100_102,
             start = list(y0=0,a=1))

masa_seca_66_102 <- datos_masa_seca %>%
  filter(VARIEDAD =="102",TRATAMIENTO.=="66% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_66_102=REND_TUB_TON_HA,
            DDS_66_102=DDS,
            TRATAMIENTO=TRATAMIENTO.)

Cuad_66_102 <- nls(REND_TUB_TON_HA_66_102~Cuadratica(DDS_66_102,y0,a),
             data=masa_seca_66_102,
             start = list(y0=0,a=1))

masa_seca_33_102 <- datos_masa_seca %>%
  filter(VARIEDAD =="102",TRATAMIENTO.=="33% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_33_102=REND_TUB_TON_HA,
            DDS_33_102=DDS,
            TRATAMIENTO_102=TRATAMIENTO.)

Cuad_33_102 <- nls(REND_TUB_TON_HA_33_102~Cuadratica(DDS_33_102,y0,a),
             data=masa_seca_33_102,
             start = list(y0=0,a=1))

masa_seca_0_102 <- datos_masa_seca %>%
  filter(VARIEDAD =="102",TRATAMIENTO.=="0% Fertilización")%>%
  group_by(DDS, TRATAMIENTO.)%>%
  summarise(REND_TUB_TON_HA_0_102=REND_TUB_TON_HA,
            DDS_0_102=DDS,
            TRATAMIENTO_102=TRATAMIENTO.)

Cuad_0_102 <- nls(REND_TUB_TON_HA_0_102~Cuadratica(DDS_0_102,y0,a),
             data=masa_seca_0_102,
             start = list(y0=0,a=1))
```

```{r}
coefs_100_102 <- coef(Cuad_100_102)
y0_100_102 = coefs_100_102[1]
a_100_102=coefs_100_102[2]

coefs_100_102

coefs_66_102 <- coef(Cuad_66_102)
y0_66_102 = coefs_66_102[1]
a_66_102=coefs_66_102[2]

coefs_66_102

coefs_33_102 <- coef(Cuad_33_102)
y0_33_102 = coefs_33_102[1]
a_33_102=coefs_33_102[2]

coefs_33_102

coefs_0_102 <- coef(Cuad_0_102)
y0_0_102 = coefs_0_102[1]
a_0_102=coefs_0_102[2]

coefs_0_102
```

```{r}
DDS_LEVELS <- seq(0,150,by=1)

par(mfrow=c(2,2))

pred <- predict(Cuad_100_102, list(x=DDS_LEVELS))
plot(REND_TUB_TON_HA_100_102~DDS_100_102, data=masa_seca_100_102, xlim=c(0,150), ylim=c(0,30),
     xlab="DDS", ylab="RENDIMIENTO total")
lines(DDS_LEVELS, Cuadratica(DDS_LEVELS, y0_100_102, a_100_102),
      lty=1, col="cadetblue3", lwd=2)

pred <- predict(Cuad_66_102, list(x=DDS_LEVELS))
plot(REND_TUB_TON_HA_66_102~DDS_66_102, data=masa_seca_66_102, xlim=c(0,150), ylim=c(0,30),
     xlab="DDS", ylab="RENDIMIENTO total")
lines(DDS_LEVELS, Cuadratica(DDS_LEVELS, y0_66_102, a_66_102),
      lty=1, col="cadetblue2", lwd=2)

pred <- predict(Cuad_33_102, list(x=DDS_LEVELS))
plot(REND_TUB_TON_HA_33_102~DDS_33_102, data=masa_seca_33_102, xlim=c(0,150), ylim=c(0,30),
     xlab="DDS", ylab="RENDIMIENTO total")
lines(DDS_LEVELS, Cuadratica(DDS_LEVELS, y0_33_102, a_33_102),
      lty=1, col="cadetblue4", lwd=2)

pred <- predict(Cuad_0_102, list(x=DDS_LEVELS))
plot(REND_TUB_TON_HA_0_102~DDS_0_102, data=masa_seca_0_102, xlim=c(0,150), ylim=c(0,25),
     xlab="DDS", ylab="RENDIMIENTO total")
lines(DDS_LEVELS, Cuadratica(DDS_LEVELS, y0_0_102, a_0_102),
      lty=1, col="seagreen2", lwd=2)

par(mfrow=c(1,1))

plot(REND_TUB_TON_HA_102~DDS_102, data=masa_seca_102, xlim=c(0,150), ylim=c(0,25),
     xlab="DDS", ylab="Rendimiento total (ton/ha)")
lines(DDS_LEVELS, Cuadratica(DDS_LEVELS, y0_66_102, a_66_102),
      lty=1, col="cadetblue2", lwd=2)
lines(DDS_LEVELS, Cuadratica(DDS_LEVELS, y0_100_102, a_100_102),
      lty=1, col="cadetblue3", lwd=2)
lines(DDS_LEVELS, Cuadratica(DDS_LEVELS, y0_33_102, a_33_102),
      lty=1, col="cadetblue4", lwd=2)
lines(DDS_LEVELS, Cuadratica(DDS_LEVELS, y0_0_102, a_0_102),
      lty=1, col="seagreen2", lwd=2)
legend("topleft", legend=c("100% Fertilización", "66% Fertilización", "33% Fertilización", "0% Fertilización"), lwd = 3, col = c("cadetblue3","cadetblue2","cadetblue4", "seagreen2"))
```

```{r}
RENDIMIENTOs_savia_100_102 <-Cuadratica(c(36,45,53,61,70,78,84,91,98,105,115),y0_100_102,a_100_102)
DDS_100_102 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_100_102 <- rep("100% Fertilización",11)
Tabla_RENDIMIENTOs_savia_100_102 <- data.frame(RENDIMIENTOs_savia_100_102,DDS_100_102,TRATAMIENTO_100_102)
Tabla_RENDIMIENTOs_savia_100_102

RENDIMIENTOs_savia_66_102 <- Cuadratica(c(36,45,53,61,70,78,84,91,98,105,115),y0_66_102,a_66_102)
DDS_66_102 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_66_102 <- rep("66% Fertilización",11)
Tabla_RENDIMIENTOs_savia_66_102 <- data.frame(RENDIMIENTOs_savia_66_102,DDS_66_102,TRATAMIENTO_66_102)
Tabla_RENDIMIENTOs_savia_66_102

RENDIMIENTOs_savia_33_102 <- Cuadratica(c(36,45,53,61,70,78,84,91,98,105,115),y0_33_102,a_33_102)
DDS_33_102 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_33_102 <- rep("33% Fertilización",11)
Tabla_RENDIMIENTOs_savia_33_102 <- data.frame(RENDIMIENTOs_savia_33_102,DDS_33_102,TRATAMIENTO_33_102)
Tabla_RENDIMIENTOs_savia_33_102

RENDIMIENTOs_savia_0_102 <- Gompertz(c(36,45,53,61,70,78,84,91,98,105,115),y0_0_39,ymax_0_39,k_0_39,lag_0_39)
DDS_0_102 <- c(36,45,53,61,70,78,84,91,98,105,115)
TRATAMIENTO_0_102 <- rep("0% Fertilización",11)
Tabla_RENDIMIENTOs_savia_0_102 <- data.frame(RENDIMIENTOs_savia_0_102,DDS_0_102,TRATAMIENTO_0_102)
Tabla_RENDIMIENTOs_savia_0_102
```

### 5) RENDIMIENTO V.S. CONTENIDO EN SAVIA

# NO3

# CPI 1

```{r}
library(dplyr)

mccain_savia_0_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_0_1 <- cbind(mccain_savia_0_1$Variedad,Tabla_RENDIMIENTOs_savia_0_1, mccain_savia_0_1$NO3)
colnames(Tabla_0_1) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','NO3')

mccain_savia_33_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_33_1 <- cbind(mccain_savia_33_1$Variedad,Tabla_RENDIMIENTOs_savia_33_1, mccain_savia_33_1$NO3)
colnames(Tabla_33_1) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','NO3')

mccain_savia_66_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_66_1 <- cbind(mccain_savia_66_1$Variedad,Tabla_RENDIMIENTOs_savia_66_1, mccain_savia_66_1$NO3)
colnames(Tabla_66_1) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','NO3')

mccain_savia_100_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_100_1 <- cbind(mccain_savia_100_1$Variedad,Tabla_RENDIMIENTOs_savia_100_1, mccain_savia_100_1$NO3)
colnames(Tabla_100_1) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','NO3')

Tabla_1 <- rbind(Tabla_0_1,Tabla_33_1, Tabla_66_1, Tabla_100_1)

Tabla_1
```

# CIP 39

```{r}
mccain_savia_0_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_0_39 <- cbind(mccain_savia_0_39$Variedad,Tabla_RENDIMIENTOs_savia_0_39, mccain_savia_0_39$NO3)
colnames(Tabla_0_39) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','NO3')

mccain_savia_33_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_33_39 <- cbind(mccain_savia_33_39$Variedad,Tabla_RENDIMIENTOs_savia_33_39, mccain_savia_33_39$NO3)
colnames(Tabla_33_39) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','NO3')

mccain_savia_66_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_66_39 <- cbind(mccain_savia_66_39$Variedad,Tabla_RENDIMIENTOs_savia_66_39, mccain_savia_66_39$NO3)
colnames(Tabla_66_39) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','NO3')

mccain_savia_100_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_100_39 <- cbind(mccain_savia_100_39$Variedad,Tabla_RENDIMIENTOs_savia_100_39, mccain_savia_100_39$NO3)
colnames(Tabla_100_39) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','NO3')

Tabla_39 <- rbind(Tabla_0_39,Tabla_33_39, Tabla_66_39, Tabla_100_39)

Tabla_39
```

# CIP 102

```{r}
mccain_savia_0_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_0_102 <- cbind(mccain_savia_0_102$Variedad,Tabla_RENDIMIENTOs_savia_0_102, mccain_savia_0_102$NO3)
colnames(Tabla_0_102) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','NO3')

mccain_savia_33_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_33_102 <- cbind(mccain_savia_33_102$Variedad,Tabla_RENDIMIENTOs_savia_33_102, mccain_savia_33_102$NO3)
colnames(Tabla_33_102) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','NO3')

mccain_savia_66_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_66_102 <- cbind(mccain_savia_66_102$Variedad,Tabla_RENDIMIENTOs_savia_66_102, mccain_savia_66_102$NO3)
colnames(Tabla_66_102) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','NO3')

mccain_savia_100_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(NO3 = mean(NO3, na.rm=T))

Tabla_100_102 <- cbind(mccain_savia_100_102$Variedad,Tabla_RENDIMIENTOs_savia_100_102, mccain_savia_100_102$NO3)
colnames(Tabla_100_102) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','NO3')

Tabla_102 <- rbind(Tabla_0_102,Tabla_33_102, Tabla_66_102, Tabla_100_102)

Tabla_102
```

# Gráficos

```{r}
NO3CPI1 <-  Tabla_1%>%
  group_by(DDS,Tratamiento)%>%
  summarise(NITRATO=mean(NO3,na.rm=T),
            RENDIMIENTO=RENDIMIENTO,
            TRATAMIENTO=Tratamiento,
            SE=sd(NO3,na.rm=T)/sqrt(length(complete.cases(NO3))))

ggplot(NO3CPI1,aes(x=RENDIMIENTO, y=NITRATO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,10000,500))+
  scale_x_continuous(breaks=seq(0,13,1))+
  labs(title="Nitrato en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 1", x="Rendimiento (ton/ha)", y="Contenido de nitrato (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema

NO3CPI39 <-  Tabla_39%>%
  group_by(DDS,Tratamiento)%>%
  summarise(NITRATO=mean(NO3,na.rm=T),
            RENDIMIENTO=RENDIMIENTO,
            TRATAMIENTO=Tratamiento,
            SE=sd(NO3,na.rm=T)/sqrt(length(complete.cases(NO3))))

ggplot(NO3CPI39,aes(x=RENDIMIENTO, y=NITRATO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,10000,500))+
  scale_x_continuous(breaks=seq(0,13,1))+
  labs(title="Nitrato en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 39", x="Rendimiento (ton/ha)", y="Contenido de nitrato (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema

NO3CPI102 <-  Tabla_102%>%
  group_by(DDS,Tratamiento)%>%
  summarise(NITRATO=mean(NO3,na.rm=T),
            RENDIMIENTO=RENDIMIENTO,
            TRATAMIENTO=Tratamiento,
            SE=sd(NO3,na.rm=T)/sqrt(length(complete.cases(NO3))))

ggplot(NO3CPI102,aes(x=RENDIMIENTO, y=NITRATO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,10000,500))+
  scale_x_continuous(breaks=seq(0,13,1))+
  labs(title="Nitrato en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 102", x="Rendimiento (ton/ha)", y="Contenido de nitrato (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema
```

# Ca

# CPI 1

```{r}
mccain_savia_0_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_0_1 <- cbind(mccain_savia_0_1$Variedad,Tabla_RENDIMIENTOs_savia_0_1, mccain_savia_0_1$Ca)
colnames(Tabla_0_1) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','Ca')

mccain_savia_33_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_33_1 <- cbind(mccain_savia_33_1$Variedad,Tabla_RENDIMIENTOs_savia_33_1, mccain_savia_33_1$Ca)
colnames(Tabla_33_1) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','Ca')

mccain_savia_66_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_66_1 <- cbind(mccain_savia_66_1$Variedad,Tabla_RENDIMIENTOs_savia_66_1, mccain_savia_66_1$Ca)
colnames(Tabla_66_1) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','Ca')

mccain_savia_100_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_100_1 <- cbind(mccain_savia_100_1$Variedad,Tabla_RENDIMIENTOs_savia_100_1, mccain_savia_100_1$Ca)
colnames(Tabla_100_1) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','Ca')

Tabla_1 <- rbind(Tabla_0_1,Tabla_33_1, Tabla_66_1, Tabla_100_1)

Tabla_1
```

# CIP 39

```{r}
mccain_savia_0_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_0_39 <- cbind(mccain_savia_0_39$Variedad,Tabla_RENDIMIENTOs_savia_0_39, mccain_savia_0_39$Ca)
colnames(Tabla_0_39) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','Ca')

mccain_savia_33_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_33_39 <- cbind(mccain_savia_33_39$Variedad,Tabla_RENDIMIENTOs_savia_33_39, mccain_savia_33_39$Ca)
colnames(Tabla_33_39) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','Ca')

mccain_savia_66_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_66_39 <- cbind(mccain_savia_66_39$Variedad,Tabla_RENDIMIENTOs_savia_66_39, mccain_savia_66_39$Ca)
colnames(Tabla_66_39) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','Ca')

mccain_savia_100_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_100_39 <- cbind(mccain_savia_100_39$Variedad,Tabla_RENDIMIENTOs_savia_100_39, mccain_savia_100_39$Ca)
colnames(Tabla_100_39) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','Ca')

Tabla_39 <- rbind(Tabla_0_39,Tabla_33_39, Tabla_66_39, Tabla_100_39)

Tabla_39
```

# CIP 102

```{r}
mccain_savia_0_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_0_102 <- cbind(mccain_savia_0_102$Variedad,Tabla_RENDIMIENTOs_savia_0_102, mccain_savia_0_102$Ca)
colnames(Tabla_0_102) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','Ca')

mccain_savia_33_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_33_102 <- cbind(mccain_savia_33_102$Variedad,Tabla_RENDIMIENTOs_savia_33_102, mccain_savia_33_102$Ca)
colnames(Tabla_33_102) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','Ca')

mccain_savia_66_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_66_102 <- cbind(mccain_savia_66_102$Variedad,Tabla_RENDIMIENTOs_savia_66_102, mccain_savia_66_102$Ca)
colnames(Tabla_66_102) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','Ca')

mccain_savia_100_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(Ca = mean(Ca, na.rm=T))

Tabla_100_102 <- cbind(mccain_savia_100_102$Variedad,Tabla_RENDIMIENTOs_savia_100_102, mccain_savia_100_102$Ca)
colnames(Tabla_100_102) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','Ca')

Tabla_102 <- rbind(Tabla_0_102,Tabla_33_102, Tabla_66_102, Tabla_100_102)

Tabla_102
```

# Gráficos

```{r}
CaCPI1 <-  Tabla_1%>%
  group_by(DDS,Tratamiento)%>%
  summarise(CALCIO=mean(Ca,na.rm=T),
            RENDIMIENTO=RENDIMIENTO,
            TRATAMIENTO=Tratamiento,
            SE=sd(Ca,na.rm=T)/sqrt(length(complete.cases(Ca))))

ggplot(CaCPI1,aes(x=RENDIMIENTO, y=CALCIO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,20,1))+
  scale_x_continuous(breaks=seq(0,13,1))+
  labs(title="Calcio en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 1", x="Rendimiento (ton/ha)", y="Contenido de calcio (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema

CaCPI39 <-  Tabla_39%>%
  group_by(DDS,Tratamiento)%>%
  summarise(CALCIO=mean(Ca,na.rm=T),
            RENDIMIENTO=RENDIMIENTO,
            TRATAMIENTO=Tratamiento,
            SE=sd(Ca,na.rm=T)/sqrt(length(complete.cases(Ca))))

ggplot(CaCPI39,aes(x=RENDIMIENTO, y=CALCIO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,20,2))+
  scale_x_continuous(breaks=seq(0,13,1))+
  labs(title="Calcio en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 39", x="Rendimiento (ton/ha)", y="Contenido de calcio (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema

CaCPI102 <-  Tabla_102%>%
  group_by(DDS,Tratamiento)%>%
  summarise(CALCIO=mean(Ca,na.rm=T),
            RENDIMIENTO=RENDIMIENTO,
            TRATAMIENTO=Tratamiento,
            SE=sd(Ca,na.rm=T)/sqrt(length(complete.cases(Ca))))

ggplot(CaCPI102,aes(x=RENDIMIENTO, y=CALCIO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,5,0.01))+
  scale_x_continuous(breaks=seq(0,13,1))+
  labs(title="Calcio en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 102", x="Rendimiento (ton/ha)", y="Contenido de calcio (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema
```

# K

# CPI 1

```{r}
mccain_savia_0_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_0_1 <- cbind(mccain_savia_0_1$Variedad,Tabla_RENDIMIENTOs_savia_0_1, mccain_savia_0_1$K)
colnames(Tabla_0_1) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','K')

mccain_savia_33_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_33_1 <- cbind(mccain_savia_33_1$Variedad,Tabla_RENDIMIENTOs_savia_33_1, mccain_savia_33_1$K)
colnames(Tabla_33_1) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','K')

mccain_savia_66_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_66_1 <- cbind(mccain_savia_66_1$Variedad,Tabla_RENDIMIENTOs_savia_66_1, mccain_savia_66_1$K)
colnames(Tabla_66_1) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','K')

mccain_savia_100_1 <- mccain_savia %>%
  filter(Variedad =="CIP 1", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_100_1 <- cbind(mccain_savia_100_1$Variedad,Tabla_RENDIMIENTOs_savia_100_1, mccain_savia_100_1$K)
colnames(Tabla_100_1) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','K')

Tabla_1 <- rbind(Tabla_0_1,Tabla_33_1, Tabla_66_1, Tabla_100_1)

Tabla_1
```

# CIP 39

```{r}
mccain_savia_0_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_0_39 <- cbind(mccain_savia_0_39$Variedad,Tabla_RENDIMIENTOs_savia_0_39, mccain_savia_0_39$K)
colnames(Tabla_0_39) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','K')

mccain_savia_33_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_33_39 <- cbind(mccain_savia_33_39$Variedad,Tabla_RENDIMIENTOs_savia_33_39, mccain_savia_33_39$K)
colnames(Tabla_33_39) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','K')

mccain_savia_66_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_66_39 <- cbind(mccain_savia_66_39$Variedad,Tabla_RENDIMIENTOs_savia_66_39, mccain_savia_66_39$K)
colnames(Tabla_66_39) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','K')

mccain_savia_100_39 <- mccain_savia %>%
  filter(Variedad =="CIP 39", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_100_39 <- cbind(mccain_savia_100_39$Variedad,Tabla_RENDIMIENTOs_savia_100_39, mccain_savia_100_39$K)
colnames(Tabla_100_39) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','K')

Tabla_39 <- rbind(Tabla_0_39,Tabla_33_39, Tabla_66_39, Tabla_100_39)

Tabla_39
```

# CIP 102

```{r}
mccain_savia_0_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="0% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_0_102 <- cbind(mccain_savia_0_102$Variedad,Tabla_RENDIMIENTOs_savia_0_102, mccain_savia_0_102$K)
colnames(Tabla_0_102) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','K')

mccain_savia_33_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="33% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_33_102 <- cbind(mccain_savia_33_102$Variedad,Tabla_RENDIMIENTOs_savia_33_102, mccain_savia_33_102$K)
colnames(Tabla_33_102) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','K')

mccain_savia_66_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="66% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_66_102 <- cbind(mccain_savia_66_102$Variedad,Tabla_RENDIMIENTOs_savia_66_102, mccain_savia_66_102$K)
colnames(Tabla_66_102) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','K')

mccain_savia_100_102 <- mccain_savia %>%
  filter(Variedad =="CIP 102", Tratamiento =="100% Fertilización")%>%
  group_by(DDS,Variedad,Tratamiento)%>%
  summarise(K = mean(K, na.rm=T))

Tabla_100_102 <- cbind(mccain_savia_100_102$Variedad,Tabla_RENDIMIENTOs_savia_100_102, mccain_savia_100_102$K)
colnames(Tabla_100_102) <- c('Variedad','RENDIMIENTO','DDS','Tratamiento','K')

Tabla_102 <- rbind(Tabla_0_102, Tabla_33_102, Tabla_66_102, Tabla_100_102)

Tabla_102
```

# Gráficos

```{r}
KCPI1 <-  Tabla_1%>%
  group_by(DDS,Tratamiento)%>%
  summarise(POTASIO=mean(K,na.rm=T),
            RENDIMIENTO=RENDIMIENTO,
            TRATAMIENTO=Tratamiento,
            SE=sd(K,na.rm=T)/sqrt(length(complete.cases(K))))

ggplot(KCPI1,aes(x=RENDIMIENTO, y=POTASIO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,10000,500))+
  scale_x_continuous(breaks=seq(0,13,1))+
  labs(title="Potasio en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 1", x="Rendimiento (ton/ha)", y="Contenido de potasio (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema

KCPI39 <-  Tabla_39%>%
  group_by(DDS,Tratamiento)%>%
  summarise(POTASIO=mean(K,na.rm=T),
            RENDIMIENTO=RENDIMIENTO,
            TRATAMIENTO=Tratamiento,
            SE=sd(K,na.rm=T)/sqrt(length(complete.cases(K))))

ggplot(KCPI39,aes(x=RENDIMIENTO, y=POTASIO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,10000,500))+
  scale_x_continuous(breaks=seq(0,13,1))+
  labs(title="Potasio en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 39", x="Rendimiento (ton/ha)", y="Contenido de potasio (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema

KCPI102 <-  Tabla_102%>%
  group_by(DDS,Tratamiento)%>%
  summarise(POTASIO=mean(K,na.rm=T),
            RENDIMIENTO=RENDIMIENTO,
            TRATAMIENTO=Tratamiento,
            SE=sd(K,na.rm=T)/sqrt(length(complete.cases(K))))

ggplot(KCPI102,aes(x=RENDIMIENTO, y=POTASIO, group = TRATAMIENTO, colour =TRATAMIENTO)) + 
  geom_line(size = 1)  +
  scale_y_continuous(breaks=seq(0,10000,500))+
  scale_x_continuous(breaks=seq(0,13,1))+
  labs(title="Potasio en savia", subtitle="Representación gráfica de valores obtenidos mediante modelamiento",caption="Variedad 102", x="Rendimiento (ton/ha)", y="Contenido de potasio (ppm)")+
  geom_point( size=2, fill="white") +
  scale_color_manual(values=c("seagreen2","cadetblue3","cadetblue4","cadetblue2"))+
  tema
```
